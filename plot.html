<!DOCTYPE html>
<html>
  <head>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>

    <style>
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script>
      Highcharts.chart('container', {
          chart: {
              type: 'column'
          },
          data: {
              enablePolling: false, // for now :) 
              csvURL: 'https://storage.googleapis.com/c2s_developer_exercise/Sri-Lanka_GSMaP_20180516_20180612.csv'
          },
          title: {
              text: 'Fruit Consumption'
          },
          xAxis: {
            labels: {
              formatter: function () {
                // const dateRegex = /(\d{4})(\d{2})(\d{2})/;
                // const date = String(this.value).match(dateRegex);
                // const [d, year, month, day] = date;
                // return year + '-' + month + '-' + day;
                const d = moment(this.value, 'YYYYMMDD');
                return d.toDate();
              }
            },
            type: 'category'
          },
          yAxis: {
              title: {
                  text: 'Precipitation'
              }
          },
          tooltip: {
              formatter: function () {
                  return 'The value for <b>' + this.x +
                      '</b> is <b>' + this.y + '</b>';
              }
          },
          plotOptions: {
                  series: {
                      dataLabels: {
                          // enabled: true,
                      }
                  }
              },
      });
    </script>
  </body>
</html>
